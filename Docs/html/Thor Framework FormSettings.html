<div class="wikidoc">
<p><strong>FormSettings Object</strong></p>
<p>This object allows forms to save their settings (size, position, and any other form properties) and align the form to the mouse or cursor position.</p>
<p>The FormSettings Object can be obtained from this single line of code, which is usually placed in a form’s Init method:</p>
<pre style="padding-left:60px">loSettings = Execscript (_Screen.cThorDispatcher, 'class= ThorFormSettings', lxFormID)</pre>
<p>Where lxFormID is either </p>
<ul>
<li>ThisForm (but only if called within an SCX) </li><li>or the name of the file to be used for saving settings (such as ‘GoToMethod.Settings’)
</li></ul>
<p>In order for this object to be used later (when the form closes), it must be saved as a form property:
</p>
<pre style="padding-left:60px">Thisform.AddProperty(‘oSettings’, loSettings)</pre>
<p>This object can then be used as follows:</p>
<table border="0" cellspacing="0" cellpadding="2" width="795">
<tbody>
<tr>
<td valign="top" width="212"><strong>Method</strong></td>
<td valign="top" width="581"><strong>Meaning</strong></td>
</tr>
<tr>
<td valign="top" width="212">.Restore(ThisForm)</td>
<td valign="top" width="581">Restores the saved settings for Top, Left, Height, and Width</td>
</tr>
<tr>
<td valign="top" width="212">.Restore(ThisForm, ‘propertylist’)</td>
<td valign="top" width="581">Restores the values for all properties named in {propertylist}, which is a character string of existing property names, delimited with commas.</td>
</tr>
<tr>
<td valign="top" width="212">.AlignToCursor(ThisForm, llAlignToMouse, tnVerticalAdjustment, tnHorizontalAdjustment)</td>
<td valign="top" width="581">Aligns the form (Top and Left properties) to the cursor position in the current edit window, if possible.&#160; If the current window is not a edit window or llAlignToMouse = .T. , the form is aligned to the cursor position instead.</td>
</tr>
<tr>
<td valign="top" width="212">.Save(ThisForm)</td>
<td valign="top" width="581">Saves values of properties from the form so that they may be restored in the next session.&#160; The properties that are saved are all those that had been restored with all calls to .Restore.&#160; This call is usually made in the
 Form’s Destroy event</td>
</tr>
</tbody>
</table>
<p>&#160;</p>
<p><strong>Sample usage:</strong></p>
<p>In the form’s ‘<strong>Init</strong>’ event:</p>
<pre style="padding-left:60px">* ThorFormSettings home page = <a href="http://vfpx.codeplex.com/wikipage?title=Thor%20Framework%20FormSettingsloSettings">http://vfpx.codeplex.com/wikipage?title=Thor%20Framework%20FormSettings
loSettings</a> = ExecScript(_Screen.cThorDispatcher, &quot;Class= ThorFormSettings&quot;, lxFormID)
Thisform.AddProperty ('oSettings', loSettings)
loSettings.Restore (Thisform) &amp;&amp; Gets top, left, height, width
loSettings.Restore (Thisform, 'nObjectType, cSearchString') &amp;&amp; and two other properties</pre>
<p>Where lxFormID is either </p>
<ul>
<li>ThisForm (but only if called within an SCX) </li><li>or the name of the file to be used for saving settings (such as ‘GoToMethod.Settings’)
</li></ul>
<p>&#160;</p>
<p>And in the form’s ‘<strong>Destroy’</strong> event: </p>
<pre style="padding-left:60px">This.oSettings.Save (This)
This.oSettings = .Null.</pre>
</div><div class="ClearBoth"></div>