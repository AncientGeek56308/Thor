<div class="wikidoc">
<h3 align="center">Thor TWEeT #9: Extract to Variable and Extract to Constant</h3>
<p>In <a href="https://vfpx.codeplex.com/wikipage?title=Thor%20TWEeT%208">last week's TWEeT</a>, I showed how you can highlight a block of text from a code window and save it into a new method.</p>
<p>There are two other closely related tools:</p>
<ul>
<li><strong>Extract to Variable</strong> </li><li><strong>Extract to Constant</strong> </li></ul>
<p>Use <strong>Extract to Variable</strong> to replace text in a line of code with a reference to a local variable, such as in this example where&nbsp;
<font face="Consolas">laFileList[lnJ, 1]</font>&nbsp; is referenced a couple of times:</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775256"><img title="SNAGHTML8645452" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775257" alt="SNAGHTML8645452" width="683" height="280" border="0" style="padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-width:0px"></a></p>
<p>&nbsp;</p>
<p>The form that pops up allows you to enter the name of the new variable, whether all occurrences of the string are to be replaced (if not, only the highlighted one will be), and whether tool &lsquo;Create Locals&rsquo; should be run to add this new variable
 to your LOCAL statements.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775258"><img title="SNAGHTML864be89" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775259" alt="SNAGHTML864be89" width="350" height="253" border="0" style="padding-top:0px; padding-left:100px; display:inline; padding-right:0px; border-width:0px"></a></p>
<p>&nbsp;</p>
<p>The modified code looks like this:</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775260"><img title="SNAGHTML865333b" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775261" alt="SNAGHTML865333b" width="683" height="280" border="0" style="padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-width:0px"></a></p>
<p>&nbsp;</p>
<p><strong>Extract to Constant</strong> works in a similar fashion, except that it creates a #Define statement either at the top of the current code window or in any of the #Include files that apply to the code window:</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775262"><img title="image" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775263" alt="image" width="352" height="269" border="0" style="padding-top:0px; padding-left:100px; display:inline; padding-right:0px; border-width:0px"></a></p>
<p>&nbsp;</p>
<p>I find that these three related tools, <strong>Extract to Method / Variable / Constant</strong>, to be of considerable value but I do not use any one of them often enough to assign hot keys to each of them.&nbsp; Instead, I use a&nbsp;
<a href="https://vfpx.codeplex.com/wikipage?title=Thor%20Create%20Popup%20Menu&referringTitle=Thor%20Help">
Popup Men</a>, which I bring up by using a single hot key (I have chosen Ctrl&#43;E, for &ldquo;Extract&rdquo;).</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775264"><img title="image" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=vfpx&DownloadId=775265" alt="image" width="158" height="77" border="0" style="padding-top:0px; padding-left:100px; display:inline; padding-right:0px; border-width:0px"></a></p>
<p>There is a Thor tool to create this popup menu and a number of others.&nbsp; Just execute
<strong>Create Sample menus</strong> once and a number of menus will be created; see the first page of the Thor Configuration screen.</p>
<p>See also&nbsp;<a href="https://vfpx.codeplex.com/wikipage?title=TWEeTs">History of all Thor TWEeTs</a>&nbsp;and&nbsp;<a href="https://groups.google.com/forum/?fromgroups#!forum/FoxProThor">the Thor Forum</a>.</p>
</div><div class="ClearBoth"></div>